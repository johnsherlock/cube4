<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CUBE4 - 3D Four-in-a-Row</title>
  <link rel="icon" type="image/png" sizes="16x16" href="img/Cube4Logo16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="img/Cube4Logo32.png" />
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="stylesheet" href="src/styles.css" />
</head>

<body>
  <div id="ui">
    <div id="left">
      <div class="pill" id="status">Current Player: Red</div>
      <div class="pill" id="score"><span class="lbl">SCORE</span><span id="scoreText">Red 0 - 0 Blue</span></div>
    </div>
    <div id="right">
      <button class="pill" id="exitDemoBtn" style="display:none;">Exit demo</button>
      <!-- Desktop controls -->
      <button class="pill" id="undoBtn" disabled>Undo</button>
      <button class="pill" id="resetBtn">Reset</button>
      <button class="pill icon" id="helpBtn" title="Rules" aria-label="Rules">?</button>
      <button class="pill icon" id="settingsBtn" title="Options" aria-label="Options">âš™</button>

      <!-- Mobile menu (shown via CSS media query) -->
      <select class="pill" id="mobileMenu" aria-label="Menu">
        <option value="" selected>Menu</option>
        <option value="undo">Undo last move</option>
        <option value="reset">Reset match</option>
        <option value="options">Match options</option>
        <option value="help">Help</option>
      </select>
    </div>
  </div>

  <!-- Help / Welcome overlay (non-blocking; no X; no escape for welcome) -->
  <div class="overlay" id="helpOverlay" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
      <h1 class="cardTitle" id="helpTitle">Welcome to CUBE4</h1>
      <div class="helpBody" id="helpBody">
        <p><b>Goal:</b> be the first to make a line of <b>four</b> of your pieces in the 4x4x4 cube - in <b>any direction</b> (across rows, columns, verticals, or diagonals through space).</p>
        <ul>
          <li><b>Rotate:</b> click-and-drag (one finger on mobile)</li>
          <li><b>Zoom:</b> scroll wheel / trackpad / pinch</li>
          <li><b>Place:</b> tap a marker to select a level, then tap a spot on that level</li>
          <li><b>Win:</b> winning 4 are outlined in yellow</li>
        </ul>
        <p class="tiny">Tip: Selecting focuses a single <b>level</b> of the cube to make placements easier.</p>
      </div>
      <div class="actions">
        <button class="pill" id="demoBtn">Watch demo</button>
        <button class="pill" id="helpPrimaryBtn">Start playing</button>
      </div>
    </div>
  </div>

  <!-- Options overlay (blocks gameplay) -->
  <div class="overlay" id="settingsOverlay" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
      <h1 class="cardTitle" id="settingsTitle">Match Options</h1>
      <div class="settingsBody">
        <div class="row">
          <label for="playersSel">Players</label>
          <select class="pill" id="playersSel">
            <option value="1" selected>Player vs CPU</option>
            <option value="2">Two Player (turn-based)</option>
          </select>
        </div>

        <div class="row">
          <label for="player1Name">Player 1</label>
          <div class="nameRow">
            <input class="pill" id="player1Name" type="text" value="Player 1" maxlength="10" autocomplete="off" />
            <div class="swatchGroup" id="player1Color"></div>
          </div>
        </div>

        <div class="row" id="player2Row">
          <label for="player2Name" id="player2Label">Player 2</label>
          <div class="nameRow">
            <input class="pill" id="player2Name" type="text" value="Player 2" maxlength="10" autocomplete="off" />
            <div class="swatchGroup" id="player2Color"></div>
          </div>
        </div>

        <div class="row" id="difficultyRow" style="display:none;">
          <label for="difficultySel">Computer Level</label>
          <select class="pill" id="difficultySel">
            <option value="1" selected>Level 1</option>
            <option value="2">Level 2</option>
            <option value="3">Level 3</option>
            <option value="4">Level 4</option>
            <option value="5">Level 5</option>
          </select>
        </div>

        <div class="row">
          <label for="firstMoveSel">First to Move</label>
          <select class="pill" id="firstMoveSel">
            <option value="red">Player 1</option>
            <option value="blue">Player 2</option>
            <option value="random">Random</option>
            <option value="winner">Winner</option>
            <option value="alternate" selected>Alternate</option>
          </select>
        </div>

        <div class="row">
          <label for="matchSel">Match style</label>
          <select class="pill" id="matchSel">
            <option value="bo3" selected>Best of 3</option>
            <option value="bo5">Best of 5</option>
            <option value="unbounded">Unbounded</option>
          </select>
        </div>

        <p class="tiny" style="margin-top:6px; opacity:0.78;">
          Changing <b>Players</b> or <b>Computer Level</b> restarts the game and wipes the scoreboard.
        </p>
      </div>
      <div class="actions">
        <button class="pill" id="cancelSettingsBtn">Back</button>
        <button class="pill" id="closeSettingsBtn">Start match</button>
      </div>
    </div>
  </div>

  <!-- Reset confirmation (mobile menu) -->
  <div class="overlay" id="confirmOverlay" aria-hidden="true">
    <div class="card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <h1 class="cardTitle" id="confirmTitle">Reset match?</h1>
      <div class="settingsBody">
        <p id="confirmBody">This will clear the board and wipe the scoreboard for the current match.</p>
      </div>
      <div class="actions">
        <button class="pill" id="confirmNoBtn">No</button>
        <button class="pill" id="confirmYesBtn">Yes</button>
      </div>
    </div>
  </div>

  <div id="overlay">
    <div id="overlayCard">
      <h1 id="overlayTitle">RED WINS!</h1>
      <p id="overlaySub">Rotate and zoom to inspect the winning line.</p>

      <div id="difficultyPrompt" style="display:none; margin-top: 10px;">
        <div style="font-weight:900; letter-spacing:0.3px; margin-bottom:10px;">Adjust difficulty for the next match?</div>
        <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
          <button class="pill small" id="diffDownBtn">Easier</button>
          <button class="pill small" id="diffKeepBtn">Keep</button>
          <button class="pill small" id="diffUpBtn">Harder</button>
        </div>
        <div style="opacity:0.75; font-size:12px; margin-top:8px;">Current CPU level: <span id="cpuLevelText">1</span></div>
      </div>

      <button id="playAgainBtn">Play again</button>
    </div>
  </div>

  <div id="canvasWrap"></div>

  <!-- CUBE4 logo -->
  <div id="logo">CUBE<span>4</span></div>

  <!-- Difficulty indicator -->
  <div id="difficultyIndicator" class="pill small" style="position:fixed; right:14px; bottom:14px; z-index:5; pointer-events:none; opacity:0.85;">
    Difficulty: <span id="difficultyValue">1</span>
  </div>

  <script type="module" src="src/main.js"></script>
</body>
</html>
